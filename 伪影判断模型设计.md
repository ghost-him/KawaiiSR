## ArtifactDetector 

### 方案总结：从想法到蓝图

我们从一个优秀的初始想法出发，逐步构建了一个高度针对你任务的、专业的解决方案。

1.  **核心训练策略：两阶段微调（Fine-tuning）**
    *   **阶段一**：冻结 ResNet 主干网络，仅训练新添加的分类器。目的是让分类器快速学会如何利用预训练模型提取出的特征。
    *   **阶段二**：解冻所有层，使用一个**非常低的学习率**对整个网络进行微调。目的是让主干网络也稍微适应你数据（二次元图像的压缩伪影）的独特模式。

2.  **任务本质分析：内容不变性 vs. 伪影敏感性**
    *   我们认识到，像 ResNet 这样的通用模型，其设计初衷是识别图像**内容**，并对压缩伪影这类“噪声”保持**不变性**。
    *   而你的任务恰恰相反，需要对压缩伪影**极其敏感**。因此，直接将原图喂给模型并非最优解。

3.  **关键优化：基于特征工程的输入预处理**
    *   为了帮助模型“划重点”，我们决定不输入原图，而是输入一张“伪影特征图”。
    *   **高通滤波器 (HPF)**：作为一种高效的方法，它能抑制图像的平坦色块（低频内容），并极大地放大压缩带来的块效应、振铃效应等高频伪影。这在拥有大色块和锐利线条的二次元图像上效果尤其好。
    *   **小波变换 (DWT)**：作为更高阶的分析工具，它能将伪影特征分解到不同的方向（水平、垂直、对角线）和尺度上，为模型提供比单一 HPF 更丰富、更结构化的信息。

4.  **最终架构：特征融合与网络改造**
    *   **模型基座**：考虑到你的数据量（约3000-6000张），我们选择更轻量的 **ResNet18** 或 **ResNet34** 作为基础，以避免过拟合。
    *   **特征融合**：我们将 HPF 的输出（1个通道）和小波变换的三个细节子带（LH, HL, HH，共3个通道）通过**通道拼接（Channel Concatenation）**的方式，融合成一个 4 通道的输入张量。
    *   **网络改造**：为了接收这个 4 通道的输入，我们必须将 ResNet 的**第一个卷积层 `conv1` 替换掉**，将其输入通道数 `in_channels` 从 3 改为 4，同时保留网络的其余预训练权重。
    *   **分类器优化（可选）**：作为最后的锦上添花，可以将标准的单层全连接分类器，替换为一个包含 `Dropout` 层的更健壮的小型 MLP（例如 `FC -> ReLU -> Dropout -> FC`），以学习更复杂的决策边界并抑制过拟合。

5.  **数据层面：**
    *   在所有步骤开始前，必须通过过采样或数据增强等方式，解决 **300 vs 3000 的严重类别不平衡问题**，建立一个平衡的数据集。

---
